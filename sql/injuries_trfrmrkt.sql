desc transfermrkt;
desc players_trfrmrkt;
select count(*), transfermarkt_id from transfermrkt_new group by transfermarkt_id having count(*)>1;
select * from transfermrkt_new where transfermarkt_id not in (select transfermarkt_id from players_trfrmrkt);
select distinct transfermarkt_id from transfermrkt_new where player not in (select player from transfermrkt);
select * from players_trfrmrkt where transfermarkt_id in (select transfermarkt_id from transfermrkt_new where player not in (select player from transfermrkt));
select * from transfermrkt_new where transfermarkt_id = 345577;
SELECT * FROM transfermrkt order by player limit 100000;
select count(*), name from players_trfrmrkt group by name having count(*)>1;

select * from players_trfrmrkt where transfermarkt_id is null;
select * from players_trfrmrkt where transfermarkt_id>1097139 order by transfermarkt_id desc limit 10000;

select * from player_injuries_trfrmrkt;
select * from reddit_sentiments;
-- update the reddit sentiments with newly fetched trfrmrkt ids, in place of existing autogenerated trfrmrkt table ids
update reddit_sentiments r, players_trfrmrkt t set r.player_id_trfrmrkt=t.transfermarkt_id where t.id=r.player_id_trfrmrkt;
select * from reddit_sentiments r, players_trfrmrkt t where t.id=r.player_id_trfrmrkt;
select * from reddit_sentiments r, players_trfrmrkt t where t.transfermarkt_id=r.player_id_trfrmrkt;
select * from transfermrkt where id in (1454,1505);
-- update player mappings with new trfrmrkt ids
update player_mapping r, players_trfrmrkt t set r.trfrmrkt_player_id=t.transfermarkt_id where t.id=trfrmrkt_player_id ;
alter table player_mapping drop column injury_player_id;
select * from player_mapping;
rename table player_injuries_trfrmrkt to player_injuries_trfrmrkt_old;
rename table player_transfer_history to player_transfer_history_old;
SELECT id, transfermarkt_id FROM players_trfrmrkt WHERE transfermarkt_id IS NOT NULL;
SELECT * FROM players_trfrmrkt WHERE transfermarkt_id IS NULL;
desc player_injuries_trfrmrkt;
select * from player_injuries_trfrmrkt;
select * from player_transfer_history;
delete from player_injuries_trfrmrkt;
delete from player_transfer_history;
desc player_transfer_history;
/*player_injuries_trfrmrkt*/
